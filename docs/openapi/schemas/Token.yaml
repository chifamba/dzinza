# Token Schemas

# Basic token structure (legacy/simple)
Token:
  type: object
  required:
    - access_token
    - token_type
  properties:
    access_token:
      type: string
    token_type:
      type: string
      example: bearer
    expires_in:
      type: integer
      format: int32
      description: Access token lifetime in seconds.
      example: 3600
    refresh_token:
      type: string
      nullable: true

# Standard token response from auth service
AuthTokens:
  type: object
  required:
    - accessToken
    - refreshToken
    - expiresIn
  properties:
    accessToken:
      type: string
      description: The JWT access token.
    refreshToken:
      type: string
      description: The JWT refresh token.
    expiresIn:
      type: integer
      format: int32
      description: Access token lifetime in seconds from the moment of issuance.
      example: 1800

# Payload structure within a JWT access token (for documentation purposes)
TokenPayload:
  type: object
  properties:
    exp:
      type: integer
      format: int64 # Unix timestamp
      description: Expiration time of the token.
    iss:
      type: string
      description: Issuer of the token.
      example: "dzinza-auth"
    aud:
      type: string
      description: Audience of the token.
      example: "dzinza-app"
    sub: # Subject, often user ID in older systems
      type: string
      description: Subject of the token (often user ID or email).
    user_id: # Preferred field for user ID
      type: string
      format: uuid
      description: Unique identifier of the user.
    email:
      type: string
      format: email
      description: User's email.
    role:
      # $ref: './User.yaml#/UserRole' # Reference if UserRole is defined elsewhere and needed
      type: string # Or array of strings if multiple roles
      description: Role(s) of the user.
      example: "user"

# Payload structure for a JWT refresh token (for documentation purposes)
RefreshTokenPayload:
  allOf:
    - $ref: '#/TokenPayload' # Inherits common fields
    - type: object
      properties:
        jti:
          type: string
          description: JWT ID, unique identifier for this refresh token instance.
          example: "abc123xyz789"

# Request schema for refreshing a token
RefreshTokenRequest:
  type: object
  required:
    - refreshToken
  properties:
    refreshToken:
      type: string
      description: The refresh token to be used to obtain a new access token.
